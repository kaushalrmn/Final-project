<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>28c01f1693604ab1abd391e7701cfc75</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:66448,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362706869,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="J5igyF3q-I21" data-outputId="b68f95ef-4449-4a8a-c3aa-97c7ad00c0c7">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTANT: RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># TO THE CORRECT LOCATION (/kaggle/input) IN YOUR NOTEBOOK,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># THEN FEEL FREE TO DELETE THIS CELL.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: THIS NOTEBOOK ENVIRONMENT DIFFERS FROM KAGGLE&#39;S PYTHON</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ENVIRONMENT SO THERE MAY BE MISSING LIBRARIES USED BY YOUR</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># NOTEBOOK.</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tempfile <span class="im">import</span> NamedTemporaryFile</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.parse <span class="im">import</span> unquote, urlparse</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.error <span class="im">import</span> HTTPError</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> zipfile <span class="im">import</span> ZipFile</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tarfile</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>CHUNK_SIZE <span class="op">=</span> <span class="dv">40960</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>DATA_SOURCE_MAPPING <span class="op">=</span> <span class="st">&#39;sign-language-hand-gesture-recognition:https%3A</span><span class="sc">%2F%2F</span><span class="st">storage.googleapis.com</span><span class="sc">%2F</span><span class="st">kaggle-data-sets</span><span class="sc">%2F</span><span class="st">2391489</span><span class="sc">%2F</span><span class="st">4036559</span><span class="sc">%2F</span><span class="st">bundle</span><span class="sc">%2F</span><span class="st">archive.zip</span><span class="sc">%3F</span><span class="st">X-Goog-Algorithm%3DGOOG4-RSA-SHA256</span><span class="sc">%26X</span><span class="st">-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com</span><span class="sc">%252F</span><span class="st">20240417</span><span class="sc">%252F</span><span class="st">auto</span><span class="sc">%252F</span><span class="st">storage</span><span class="sc">%252F</span><span class="st">goog4_request</span><span class="sc">%26X</span><span class="st">-Goog-Date%3D20240417T023925Z</span><span class="sc">%26X</span><span class="st">-Goog-Expires%3D259200</span><span class="sc">%26X</span><span class="st">-Goog-SignedHeaders%3Dhost</span><span class="sc">%26X</span><span class="st">-Goog-Signature%3De0421c99c1ea1725cd002215ea2fa6bc71005d9b24bf03d7a537f19f3e7d72b0ab5bc6167ec138a8282b5d57c7fa6f090568dd96d3ad6a9f80df399ffe21da569447c079c7bec7f0b014b9ed592b9c448a41271fcfe68e334eea7c771345d6af4b9637dc606bfe5629033d3455d3aa293ef64f6b4cd1e4c545def47992b9acb83d2ee8fc9754f83fbed6e473304a9e68e9e3691cf5f498e77e2c329234b20bc3dc391d39d0c296296c3dca8501ab642bc8412dc17b15e49cc602b1b178ad4f2f7bcc1d173d8dd260b038a14ce9292482fcbcb17a4ee1c5501507dec466025f25d3645d598702371b1acd89c7fc569c7660ad767689949d3f0bf01b0de80c09b2&#39;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>KAGGLE_INPUT_PATH<span class="op">=</span><span class="st">&#39;/kaggle/input&#39;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>KAGGLE_WORKING_PATH<span class="op">=</span><span class="st">&#39;/kaggle/working&#39;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>KAGGLE_SYMLINK<span class="op">=</span><span class="st">&#39;kaggle&#39;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>umount <span class="op">/</span>kaggle<span class="op">/</span><span class="bu">input</span><span class="op">/</span> <span class="dv">2</span><span class="op">&gt;</span> <span class="op">/</span>dev<span class="op">/</span>null</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>shutil.rmtree(<span class="st">&#39;/kaggle/input&#39;</span>, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>os.makedirs(KAGGLE_INPUT_PATH, <span class="bn">0o777</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>os.makedirs(KAGGLE_WORKING_PATH, <span class="bn">0o777</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  os.symlink(KAGGLE_INPUT_PATH, os.path.join(<span class="st">&quot;..&quot;</span>, <span class="st">&#39;input&#39;</span>), target_is_directory<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">FileExistsError</span>:</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">pass</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  os.symlink(KAGGLE_WORKING_PATH, os.path.join(<span class="st">&quot;..&quot;</span>, <span class="st">&#39;working&#39;</span>), target_is_directory<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">FileExistsError</span>:</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">pass</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> data_source_mapping <span class="kw">in</span> DATA_SOURCE_MAPPING.split(<span class="st">&#39;,&#39;</span>):</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    directory, download_url_encoded <span class="op">=</span> data_source_mapping.split(<span class="st">&#39;:&#39;</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    download_url <span class="op">=</span> unquote(download_url_encoded)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> urlparse(download_url).path</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    destination_path <span class="op">=</span> os.path.join(KAGGLE_INPUT_PATH, directory)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> urlopen(download_url) <span class="im">as</span> fileres, NamedTemporaryFile() <span class="im">as</span> tfile:</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            total_length <span class="op">=</span> fileres.headers[<span class="st">&#39;content-length&#39;</span>]</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&#39;Downloading </span><span class="sc">{</span>directory<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>total_length<span class="sc">}</span><span class="ss"> bytes compressed&#39;</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>            dl <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> fileres.read(CHUNK_SIZE)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="bu">len</span>(data) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                dl <span class="op">+=</span> <span class="bu">len</span>(data)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                tfile.write(data)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                done <span class="op">=</span> <span class="bu">int</span>(<span class="dv">50</span> <span class="op">*</span> dl <span class="op">/</span> <span class="bu">int</span>(total_length))</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                sys.stdout.write(<span class="ss">f&quot;</span><span class="ch">\r</span><span class="ss">[</span><span class="sc">{</span><span class="st">&#39;=&#39;</span> <span class="op">*</span> done<span class="sc">}{</span><span class="st">&#39; &#39;</span> <span class="op">*</span> (<span class="dv">50</span><span class="op">-</span>done)<span class="sc">}</span><span class="ss">] </span><span class="sc">{</span>dl<span class="sc">}</span><span class="ss"> bytes downloaded&quot;</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                sys.stdout.flush()</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> fileres.read(CHUNK_SIZE)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> filename.endswith(<span class="st">&#39;.zip&#39;</span>):</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>              <span class="cf">with</span> ZipFile(tfile) <span class="im">as</span> zfile:</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                zfile.extractall(destination_path)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>              <span class="cf">with</span> tarfile.<span class="bu">open</span>(tfile.name) <span class="im">as</span> tarfile:</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                tarfile.extractall(destination_path)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="ch">\n</span><span class="ss">Downloaded and uncompressed: </span><span class="sc">{</span>directory<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> HTTPError <span class="im">as</span> e:</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;Failed to load (likely expired) </span><span class="sc">{</span>download_url<span class="sc">}</span><span class="ss"> to path </span><span class="sc">{</span>destination_path<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">OSError</span> <span class="im">as</span> e:</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;Failed to load </span><span class="sc">{</span>download_url<span class="sc">}</span><span class="ss"> to path </span><span class="sc">{</span>destination_path<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Data source import complete.&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Downloading sign-language-hand-gesture-recognition, 1080034268 bytes compressed
[==================================================] 1080034268 bytes downloaded
Downloaded and uncompressed: sign-language-hand-gesture-recognition
Data source import complete.
</code></pre>
</div>
</div>
<div class="cell markdown" id="Mvfs5pYLWtY2">
<p>#Final Project</p>
<h2 id="saign-language-recognetion">Saign Language recognetion</h2>
<h3 id="done-by">Done BY:</h3>
<p><strong>FATIMA ALMUSAWI (9000400)</strong><br> <strong>RAMANDEEP KAUR
(8976849)</strong></p>
</div>
<div class="cell code" data-execution_count="8"
data-executionInfo="{&quot;elapsed&quot;:2763,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362615013,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="iEDMz8V6WtY5">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil, os</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pathlib</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> image_dataset_from_directory</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span></code></pre></div>
</div>
<section id="loading-the-data" class="cell markdown" id="CFF24EK_WtY9">
<h2>Loading the Data</h2>
</section>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
data-executionInfo="{&quot;elapsed&quot;:195,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362749610,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="txX3LwZCWtY-" data-outputId="22d2483d-c47e-4bca-f942-bbd0e40f31a2">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read label</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>my_data <span class="op">=</span> pd.read_csv(<span class="st">&quot;../input/sign-language-hand-gesture-recognition/asl_alphabets/Training_set.csv&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>my_data</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">

  <div id="df-35900ba4-0c63-4f51-9e1e-25f1275f52a2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Image_1.jpg</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Image_2.jpg</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Image_3.jpg</td>
      <td>J</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Image_4.jpg</td>
      <td>T</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Image_5.jpg</td>
      <td>B</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>60895</th>
      <td>Image_60896.jpg</td>
      <td>S</td>
    </tr>
    <tr>
      <th>60896</th>
      <td>Image_60897.jpg</td>
      <td>I</td>
    </tr>
    <tr>
      <th>60897</th>
      <td>Image_60898.jpg</td>
      <td>X</td>
    </tr>
    <tr>
      <th>60898</th>
      <td>Image_60899.jpg</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>60899</th>
      <td>Image_60900.jpg</td>
      <td>K</td>
    </tr>
  </tbody>
</table>
<p>60900 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-35900ba4-0c63-4f51-9e1e-25f1275f52a2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-35900ba4-0c63-4f51-9e1e-25f1275f52a2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-35900ba4-0c63-4f51-9e1e-25f1275f52a2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c84122a9-e721-4251-988b-17aba7a29196">
  <button class="colab-df-quickchart" onclick="quickchart('df-c84122a9-e721-4251-988b-17aba7a29196')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c84122a9-e721-4251-988b-17aba7a29196 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_888d3dc7-4fe7-44c5-886a-dedd2adeb11e">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('my_data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_888d3dc7-4fe7-44c5-886a-dedd2adeb11e button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('my_data');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
data-executionInfo="{&quot;elapsed&quot;:198,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362754437,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="y3DKZnKsWtY_" data-outputId="5d3d475f-7f77-4257-d729-f2321d92fef7">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sort label to make it easier to read</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sorting_data<span class="op">=</span>my_data.sort_values(<span class="st">&#39;label&#39;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>sorting_data</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">

  <div id="df-1be35f28-ed3d-4b26-8f00-ddf44bcb7713" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28602</th>
      <td>Image_28603.jpg</td>
      <td>A</td>
    </tr>
    <tr>
      <th>31330</th>
      <td>Image_31331.jpg</td>
      <td>A</td>
    </tr>
    <tr>
      <th>31374</th>
      <td>Image_31375.jpg</td>
      <td>A</td>
    </tr>
    <tr>
      <th>7219</th>
      <td>Image_7220.jpg</td>
      <td>A</td>
    </tr>
    <tr>
      <th>31421</th>
      <td>Image_31422.jpg</td>
      <td>A</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13087</th>
      <td>Image_13088.jpg</td>
      <td>space</td>
    </tr>
    <tr>
      <th>45368</th>
      <td>Image_45369.jpg</td>
      <td>space</td>
    </tr>
    <tr>
      <th>19462</th>
      <td>Image_19463.jpg</td>
      <td>space</td>
    </tr>
    <tr>
      <th>45401</th>
      <td>Image_45402.jpg</td>
      <td>space</td>
    </tr>
    <tr>
      <th>15458</th>
      <td>Image_15459.jpg</td>
      <td>space</td>
    </tr>
  </tbody>
</table>
<p>60900 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1be35f28-ed3d-4b26-8f00-ddf44bcb7713')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1be35f28-ed3d-4b26-8f00-ddf44bcb7713 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1be35f28-ed3d-4b26-8f00-ddf44bcb7713');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2802a497-226f-4b5b-b01c-25734f63626c">
  <button class="colab-df-quickchart" onclick="quickchart('df-2802a497-226f-4b5b-b01c-25734f63626c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2802a497-226f-4b5b-b01c-25734f63626c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_0cb0544f-c5ba-4f1a-9b41-86843ce73e8b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('sorting_data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_0cb0544f-c5ba-4f1a-9b41-86843ce73e8b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('sorting_data');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="SAvAyPIfWtZA">

</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:259,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362760889,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="cgDuZws-WtZA" data-outputId="cad5279e-d716-408c-c161-05af56f8c5d6">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take unique labels</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>class_names <span class="op">=</span> <span class="bu">list</span>(sorting_data.label.unique())</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>class_names</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<pre><code>[&#39;A&#39;,
 &#39;B&#39;,
 &#39;C&#39;,
 &#39;D&#39;,
 &#39;E&#39;,
 &#39;F&#39;,
 &#39;G&#39;,
 &#39;H&#39;,
 &#39;I&#39;,
 &#39;J&#39;,
 &#39;K&#39;,
 &#39;L&#39;,
 &#39;M&#39;,
 &#39;N&#39;,
 &#39;O&#39;,
 &#39;P&#39;,
 &#39;Q&#39;,
 &#39;R&#39;,
 &#39;S&#39;,
 &#39;T&#39;,
 &#39;U&#39;,
 &#39;V&#39;,
 &#39;W&#39;,
 &#39;X&#39;,
 &#39;Y&#39;,
 &#39;Z&#39;,
 &#39;del&#39;,
 &#39;nothing&#39;,
 &#39;space&#39;]</code></pre>
</div>
</div>
<section id="2-data-preprocessing" class="cell markdown"
id="9Wnv2Y3UWtZA">
<h2>2-data preprocessing</h2>
<h3 id="21--organizing-data-into-files">2.1- organizing data into
files:</h3>
<p>organizing files into a directory structure that is more manageable
and suitable for training models. organizing images into folders by
class allows machine learning libraries (like TensorFlow or PyTorch) to
more easily load and label the data during training. This structured
approach not only helps in handling large datasets efficiently but also
in implementing data augmentation and other preprocessing techniques
directly during the model training process.</p>
</section>
<div class="cell code" data-execution_count="14"
data-executionInfo="{&quot;elapsed&quot;:157,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362765388,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="U1auewJyWtZB">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the Path:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>newpath <span class="op">=</span> <span class="vs">r&#39;./train&#39;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Check and Create Directory:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(newpath):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    os.makedirs(newpath)</span></code></pre></div>
</div>
<div class="cell markdown" id="Wu3x3MXGWtZB">
<p>"newpath" is a string variable that holds the path to a directory
named train in the current working directory. "os.path.exists(newpath)"
checks if this directory already exists. If the directory does not exist
(if not os.path.exists(newpath)), os.makedirs(newpath) is called to
create the directory. This ensures that there is a directory named train
where subdirectories and files can be stored.</p>
</div>
<div class="cell code" data-execution_count="15"
data-executionInfo="{&quot;elapsed&quot;:6538,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362774272,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="-iERZLV4WtZC">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating subfolders</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> class_names:</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    dest <span class="op">=</span>  <span class="vs">r&#39;./train/&#39;</span><span class="op">+</span><span class="bu">str</span>(c)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    os.makedirs(dest)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Copying Images to the Corresponding Class Folders:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">list</span>(my_data[my_data[<span class="st">&#39;label&#39;</span>]<span class="op">==</span>c][<span class="st">&#39;filename&#39;</span>]): <span class="co"># Image Id</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        get_image <span class="op">=</span> os.path.join(<span class="st">&#39;../input/sign-language-hand-gesture-recognition/asl_alphabets/train&#39;</span>, i) <span class="co"># Path to Images</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        move_image_to_cat <span class="op">=</span> shutil.copy(get_image, dest)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="9"
data-executionInfo="{&quot;elapsed&quot;:376,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713329765340,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="swW1b_gWWtZC">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># val_newpath = r&#39;./validation&#39;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if not os.path.exists(val_newpath):</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     os.makedirs(val_newpath)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for c in class_names:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     val_dest = os.path.join(val_newpath, str(c))</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     if not os.path.exists(val_dest):</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         os.makedirs(val_dest)</span></span></code></pre></div>
</div>
<div class="cell markdown" id="k66rarQJWtZD">
<p>after running theses lines of codes, now the images sorted into
folders by category.</p>
</div>
<div class="cell code" data-execution_count="111"
data-executionInfo="{&quot;elapsed&quot;:257,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713347121052,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="ZtLWxCyiWtZD">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #Define the Path:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># newpath = r&#39;./test&#39;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #Check and Create Directory:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># if not os.path.exists(newpath):</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     os.makedirs(newpath)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Assuming class_names is a list of all class names</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># for b in class_names:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     test_class_dir = os.path.join(newpath, b)</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     if not os.path.exists(test_class_dir):</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         os.makedirs(test_class_dir)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="112"
data-executionInfo="{&quot;elapsed&quot;:305,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713347128967,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="K0ZFzckRWtZE">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Set Source and Destination Directories:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># src_dir = &quot;../input/sign-language-hand-gesture-recognition/asl_alphabets/test&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dst_dir = &quot;./test&quot;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># #Copy Each JPEG File to the Destination Directory:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for jpgfile in glob.iglob(os.path.join(src_dir, &quot;*.jpg&quot;)):</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     shutil.copy(jpgfile, dst_dir)</span></span></code></pre></div>
</div>
<section id="data-splitting" class="cell markdown" id="En7CbzCUWtZE">
<h3>Data splitting</h3>
<p>Splitting Data for Validation from Training Let's subset the training
data to create a validation set. We'll use an 80-20 split</p>
</section>
<div class="cell code" data-execution_count="16"
data-executionInfo="{&quot;elapsed&quot;:156,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362780362,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="YaEVkpL6WtZE">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># First split: Separate out the initial training set and a temporary set</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>train_labels, temp_labels <span class="op">=</span> train_test_split(my_data, test_size<span class="op">=</span><span class="fl">0.30</span>, random_state<span class="op">=</span><span class="dv">42</span>)  <span class="co"># Adjust size as needed</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Second split: Divide the temporary set into validation and test sets</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>val_labels, test_labels <span class="op">=</span> train_test_split(temp_labels, test_size<span class="op">=</span><span class="fl">0.50</span>, random_state<span class="op">=</span><span class="dv">42</span>)  <span class="co"># Split the remaining 30% into two parts</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Save new train, validation, and test CSV files</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>train_labels.to_csv(<span class="st">&#39;./train.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>val_labels.to_csv(<span class="st">&#39;./validation.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>test_labels.to_csv(<span class="st">&#39;./test2.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<section id="copy-images-to-validation-directories"
class="cell markdown" id="aeW54qnMWtZF">
<h4>Copy Images to Validation Directories</h4>
<p>We will move the corresponding image files for the validation set</p>
</section>
<div class="cell code" data-execution_count="17"
data-executionInfo="{&quot;elapsed&quot;:1003,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362789918,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="LHNGm-mlWtZF">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the directories if they don&#39;t already exist</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> class_names:</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    os.makedirs(os.path.join(<span class="st">&#39;./validation&#39;</span>, c), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    os.makedirs(os.path.join(<span class="st">&#39;./test2&#39;</span>, c), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle validation files</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    val_files <span class="op">=</span> <span class="bu">list</span>(val_labels[val_labels[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> c][<span class="st">&#39;filename&#39;</span>])</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filename <span class="kw">in</span> val_files:</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        src_path <span class="op">=</span> os.path.join(<span class="st">&#39;./train&#39;</span>, c, filename)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        dest_path <span class="op">=</span> os.path.join(<span class="st">&#39;./validation&#39;</span>, c, filename)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(src_path):  <span class="co"># Ensure the file exists in the source before moving</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            shutil.move(src_path, dest_path)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle test files</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    test_files <span class="op">=</span> <span class="bu">list</span>(test_labels[test_labels[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> c][<span class="st">&#39;filename&#39;</span>])</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filename <span class="kw">in</span> test_files:</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        src_path <span class="op">=</span> os.path.join(<span class="st">&#39;./train&#39;</span>, c, filename)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        dest_path <span class="op">=</span> os.path.join(<span class="st">&#39;./test2&#39;</span>, c, filename)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(src_path):  <span class="co"># Ensure the file exists in the source before moving</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>            shutil.move(src_path, dest_path)</span></code></pre></div>
</div>
<section
id="presenting-some-data-to-make-sure-the-spllting-went-smooth-and-passing-the-data-tp-training-and-testing"
class="cell markdown" id="r_D4xWi6WtZG">
<h4>presenting some data to make sure the spllting went smooth, and
passing the data tp training and testing</h4>
</section>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:366,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362798187,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="M7p1-XbCWtZG" data-outputId="fc2a7d78-3a56-420f-a16f-ce54be51ed28">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading and Displaying the Training Set:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>train<span class="op">=</span>pd.read_csv(<span class="st">&#39;../input/sign-language-hand-gesture-recognition/asl_alphabets/Training_set.csv&#39;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">

  <div id="df-a20f302a-1e11-4862-a44c-5298da45bdd7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Image_1.jpg</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Image_2.jpg</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Image_3.jpg</td>
      <td>J</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Image_4.jpg</td>
      <td>T</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Image_5.jpg</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a20f302a-1e11-4862-a44c-5298da45bdd7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a20f302a-1e11-4862-a44c-5298da45bdd7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a20f302a-1e11-4862-a44c-5298da45bdd7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5a9e9263-4189-4896-bee1-8aaffdf7cf65">
  <button class="colab-df-quickchart" onclick="quickchart('df-5a9e9263-4189-4896-bee1-8aaffdf7cf65')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5a9e9263-4189-4896-bee1-8aaffdf7cf65 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:296,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362806926,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="YSMnJLUWWtZG" data-outputId="0cda0f49-17b2-483d-b3c6-dbf478a91152">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reading and displaying the validation set</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>validation<span class="op">=</span>pd.read_csv(<span class="st">&#39;./validation.csv&#39;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>validation.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">

  <div id="df-d8c100c3-3316-4617-ba49-857e2f68700e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Image_41334.jpg</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Image_35891.jpg</td>
      <td>X</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Image_703.jpg</td>
      <td>E</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Image_56795.jpg</td>
      <td>V</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Image_5978.jpg</td>
      <td>G</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d8c100c3-3316-4617-ba49-857e2f68700e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d8c100c3-3316-4617-ba49-857e2f68700e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d8c100c3-3316-4617-ba49-857e2f68700e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-35577672-608e-4cbc-a86a-5f16323a2119">
  <button class="colab-df-quickchart" onclick="quickchart('df-35577672-608e-4cbc-a86a-5f16323a2119')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-35577672-608e-4cbc-a86a-5f16323a2119 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:172,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362812369,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="D6h7Icw-WtZH" data-outputId="ac0df6de-7c5c-4bc4-84d5-4fda804445c3">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading and Displaying the Testing Set:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>test2<span class="op">=</span>pd.read_csv(<span class="st">&#39;./test2.csv&#39;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>test2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">

  <div id="df-3471514e-a326-4ed3-93d8-7b1b8d9b1303" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Image_10647.jpg</td>
      <td>Z</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Image_2096.jpg</td>
      <td>space</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Image_20469.jpg</td>
      <td>F</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Image_25681.jpg</td>
      <td>C</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Image_48240.jpg</td>
      <td>W</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3471514e-a326-4ed3-93d8-7b1b8d9b1303')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3471514e-a326-4ed3-93d8-7b1b8d9b1303 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3471514e-a326-4ed3-93d8-7b1b8d9b1303');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0bfe1985-d249-4919-8995-f800e3838653">
  <button class="colab-df-quickchart" onclick="quickchart('df-0bfe1985-d249-4919-8995-f800e3838653')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0bfe1985-d249-4919-8995-f800e3838653 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="21"
data-executionInfo="{&quot;elapsed&quot;:276,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362816957,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="EkWydySjWtZH">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Saving the DataFrames to New CSV Files:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>train.to_csv(<span class="st">&#39;./train.csv&#39;</span>,index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>test2.to_csv(<span class="st">&#39;./test2.csv&#39;</span>,index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<section id="exploratory-data-analysis-eda" class="cell markdown"
id="R_r1fAjBWtZH">
<h2>Exploratory Data Analysis (EDA)</h2>
<p>In machine learning, the first step before developing any robust
algorithm is to perform a thorough Exploratory Data Analysis (EDA). This
analysis is crucial for understanding the data's structure, identifying
any biases, and detecting anomalies that could affect model performance.
Our project focuses on a dataset of images, each labeled with a hand
gesture from the American Sign Language (ASL) alphabet, used for sign
language recognition.</p>
<p>The primary objective of this EDA is to meticulously explore the
dataset to ensure that the data is not only well-understood but also
aptly prepared for the subsequent stages of machine learning modeling.
This includes assessing the balance of the dataset, visualizing the data
to understand the variability within and across classes, and preparing
the data through appropriate preprocessing methods. By doing so, we aim
to maximize the effectiveness of our predictive models which will be
designed to accurately classify each hand gesture into its respective
sign language label.</p>
</section>
<section id="explore-the-labels" class="cell markdown"
id="ciB-Kl5MWtZI">
<h3>Explore the labels</h3>
<p>at the beginning we would like to see what labels we have:</p>
</section>
<div class="cell code" id="0KKlywqjWtZI"
data-outputId="740c0ae4-0da5-4df8-848d-f25e3890052d">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>class_names</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<pre><code>[&#39;A&#39;,
 &#39;B&#39;,
 &#39;C&#39;,
 &#39;D&#39;,
 &#39;E&#39;,
 &#39;F&#39;,
 &#39;G&#39;,
 &#39;H&#39;,
 &#39;I&#39;,
 &#39;J&#39;,
 &#39;K&#39;,
 &#39;L&#39;,
 &#39;M&#39;,
 &#39;N&#39;,
 &#39;O&#39;,
 &#39;P&#39;,
 &#39;Q&#39;,
 &#39;R&#39;,
 &#39;S&#39;,
 &#39;T&#39;,
 &#39;U&#39;,
 &#39;V&#39;,
 &#39;W&#39;,
 &#39;X&#39;,
 &#39;Y&#39;,
 &#39;Z&#39;,
 &#39;del&#39;,
 &#39;nothing&#39;,
 &#39;space&#39;]</code></pre>
</div>
</div>
<div class="cell markdown" id="zCrvSf4JWtZJ">
<p>so there are 29 labels</p>
</div>
<section id="basic-data-checks" class="cell markdown" id="vIN8T988WtZJ">
<h3>Basic Data Checks</h3>
<p>Shape of the Dataset: Understand how many examples (rows) and
features (columns) we have.</p>
</section>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:183,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362828296,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="jSTC04O2WtZJ" data-outputId="28dbce13-d0c0-45d2-d6e1-ff64b6c01219">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Train Shape (before split):&quot;</span>,train.shape)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Train Shape (after split):&quot;</span>, train_labels.shape)  <span class="co"># Should reflect an 80% subset</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Validation Shape:&quot;</span>, val_labels.shape)  <span class="co"># Should reflect a 20% subset</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Test Shape:&quot;</span>, test_labels.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Train Shape (before split): (60900, 2)
Train Shape (after split): (42630, 2)
Validation Shape: (9135, 2)
Test Shape: (9135, 2)
</code></pre>
</div>
</div>
<section id="data-types" class="cell markdown" id="ZL9mXQR9WtZK">
<h3>Data Types:</h3>
<p>Check the data types to see if any columns are inappropriately typed
and need conversion.</p>
</section>
<div class="cell code" data-execution_count="101"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:718,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713346773631,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="HRGiwAZJWtZK" data-outputId="1f6f3183-a53e-4682-9f48-4c6f16f4addc">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train.dtypes)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test2.dtypes)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>filename    object
label       object
dtype: object
filename    object
label       object
dtype: object
</code></pre>
</div>
</div>
<section id="missing-values" class="cell markdown" id="th1ZOFTIWtZK">
<h3>Missing Values:</h3>
<p>Check for missing values and decide on a strategy to handle them
(e.g., imputation, deletion)</p>
</section>
<div class="cell code" data-execution_count="102"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1081,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713346781523,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="NEKjfwVmWtZL" data-outputId="a590f146-f394-466f-a94a-508a2ff867e6">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train.isnull().<span class="bu">sum</span>())</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test2.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>filename    0
label       0
dtype: int64
filename    0
label       0
dtype: int64
</code></pre>
</div>
</div>
<section id="statistical-summary" class="cell markdown"
id="JghLDBrUWtZL">
<h3>Statistical Summary</h3>
<p>This involves looking at the distribution of numerical features and
understanding the central tendencies and spread.</p>
</section>
<div class="cell code" data-execution_count="103"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:622,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713346788327,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="AH-WHQQVWtZL" data-outputId="06fd2e0a-9058-40ea-8a6f-342c6f3d1d27">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train.describe())</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test2.describe())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>               filename  label
count             60900  60900
unique            60900     29
top     Image_60900.jpg      B
freq                  1   2100
               filename  label
count              9135   9135
unique             9135     29
top     Image_45164.jpg  space
freq                  1    348
</code></pre>
</div>
</div>
<section id="distribution-of-categorical-data" class="cell markdown"
id="J-P4DkHvWtZM">
<h3>Distribution of Categorical Data</h3>
<p>Since your dataset likely involves categorical data (like labels for
hand gestures), check the distribution of these categories.</p>
</section>
<div class="cell code" id="Okyi7f0CWtZM"
data-outputId="1085bdb8-b019-4486-e65f-9c5aecad87c4">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;label&#39;</span>, data<span class="op">=</span>train)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Classes in Training Set&#39;</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/1c445d16da7c4ffb3acc885a96aace405300c830.png" /></p>
</div>
</div>
<section id="checking-for-imbalance-in-the-data" class="cell markdown"
id="6d8CgJ1CWtZM">
<h3>Checking for Imbalance in the Data</h3>
<p>If some classes are over-represented or under-represented, it might
affect the performance of a machine learning model, making it biased
towards the more frequent classes</p>
</section>
<div class="cell code" id="sDMGe_J0WtZW"
data-outputId="834ca0f5-d9da-4a2e-c246-ed284bf21166">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the number of images per label to see if there&#39;s imbalance</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>label_counts <span class="op">=</span> train[<span class="st">&#39;label&#39;</span>].value_counts()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(label_counts)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>label
B          2100
del        2100
W          2100
M          2100
space      2100
R          2100
nothing    2100
O          2100
D          2100
Y          2100
G          2100
N          2100
Q          2100
F          2100
C          2100
P          2100
K          2100
Z          2100
V          2100
U          2100
X          2100
L          2100
S          2100
H          2100
I          2100
E          2100
T          2100
J          2100
A          2100
Name: count, dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="TN9jVEzZWtZX">
<p>The above output (the figure and the codes for imbalance in data)
indicates that the dataset has a very balanced distribution of labels,
with each class having 2100 instances. This is an ideal scenario for
machine learning tasks, especially in classification, because it means
that the model will not be biased towards more frequently represented
classes.</p>
</div>
<section id="data-visualization" class="cell markdown"
id="xI7hzTupWtZX">
<h3>Data Visualization</h3>
<p>lets visualizing some of these images to provide insights into the
variability within each class, which is important for understanding how
challenging the classification task might be.</p>
</section>
<div class="cell code" id="nsz0ALhyWtZY"
data-outputId="2d6c2fa0-c236-433e-c327-3fdd0f6bf8c9">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to display images for each label</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> display_images(data, path, label, num_images<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, num_images, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    selected_images <span class="op">=</span> data[data[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> label][<span class="st">&#39;filename&#39;</span>].sample(num_images)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ax, img_filename <span class="kw">in</span> <span class="bu">zip</span>(axes, selected_images):</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        img_path <span class="op">=</span> os.path.join(path, img_filename)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        image <span class="op">=</span> Image.<span class="bu">open</span>(img_path)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        ax.imshow(image)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        ax.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of displaying images for the label &#39;A&#39;</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Displaying images for the label A&#39;</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>display_images(train, <span class="st">&#39;./data/asl_alphabets/train&#39;</span>, <span class="st">&#39;A&#39;</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of displaying images for the label &#39;X&#39;</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Displaying images for the label X&#39;</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>display_images(train, <span class="st">&#39;./data/asl_alphabets/train&#39;</span>, <span class="st">&#39;X&#39;</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of displaying images for the label &#39;Del&#39;</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Displaying images for the label Del&#39;</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>display_images(train, <span class="st">&#39;./data/asl_alphabets/train&#39;</span>, <span class="st">&#39;del&#39;</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of displaying images for the label &#39;nothing&#39;</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Displaying images for the label nothing&#39;</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>display_images(train, <span class="st">&#39;./data/asl_alphabets/train&#39;</span>, <span class="st">&#39;nothing&#39;</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of displaying images for the label &#39;space&#39;</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Displaying images for the label space&#39;</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>display_images(train, <span class="st">&#39;./data/asl_alphabets/train&#39;</span>, <span class="st">&#39;space&#39;</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Displaying images for the label A
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/b17188ef2142e5d666b9d53ae93b70e056003cd7.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Displaying images for the label X
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/0e0cbaf6c01dfe665fa2ec1b7d20b6d3bd6567ee.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Displaying images for the label Del
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/271a7854199d477e8c84f42310c9fc15dbc5abc6.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Displaying images for the label nothing
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/2a263b9bac34431d0c14a9ba1af63c97bd59ce96.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Displaying images for the label space
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/5769d2a6827d87e4074fdf9a85ec116d80c9c06d.png" /></p>
</div>
</div>
<section
id="displaying-distribution-and-most-common-colors-in-the-random-images"
class="cell markdown" id="rWCHBIzmWtZY">
<h4>displaying distribution and most common colors in the random
images</h4>
</section>
<div class="cell code" id="gPzl-qSAWtZZ"
data-outputId="47474b61-6ccf-4681-b9c8-c133bd0b9c54">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> patches</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_color_distribution(image_path):</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    image <span class="op">=</span> Image.<span class="bu">open</span>(image_path)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    pixels <span class="op">=</span> np.array(image)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> pixels:</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> pixel <span class="kw">in</span> row:</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>            colors[<span class="bu">tuple</span>(pixel)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plotting only the 10 most common colors</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    common_colors <span class="op">=</span> <span class="bu">sorted</span>(colors, key<span class="op">=</span>colors.get, reverse<span class="op">=</span><span class="va">True</span>)[:<span class="dv">10</span>]</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, color <span class="kw">in</span> <span class="bu">enumerate</span>(common_colors):</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>        ax.add_patch(patches.Rectangle((i, <span class="dv">0</span>), <span class="dv">1</span>, <span class="dv">1</span>, color<span class="op">=</span>np.array(color)<span class="op">/</span><span class="dv">255</span>))</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks([])</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">&#39;Most Common Colors in Image&#39;</span>)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>plot_color_distribution(<span class="st">&#39;data/asl_alphabets/train/image_50.jpg&#39;</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>plot_color_distribution(<span class="st">&#39;data/asl_alphabets/train/image_20.jpg&#39;</span>)</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>plot_color_distribution(<span class="st">&#39;data/asl_alphabets/train/image_1.jpg&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/5c049fbc8d45edf84480c51c96025f6330e6ce0d.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/a01b27b6e02b1b13f8f103ee7a4cbf93fc505cc6.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/911134bbf463515c599955a257c7409569e26c8d.png" /></p>
</div>
</div>
<section id="data-augmentation" class="cell markdown" id="5L692yjVWtZZ">
<h3>Data Augmentation</h3>
<p>Given that sign language recognition might be sensitive to variations
like lighting, angle, and background, consider using data augmentation
to make our model more robust to such variations:</p>
</section>
<div class="cell code" data-execution_count="123"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3225,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713347406792,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="0Q-cVs8-WtZZ" data-outputId="45d724a4-c9f1-4266-8dbb-7154af256c96">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the data generators for train and validation sets</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>train_datagen <span class="op">=</span> ImageDataGenerator(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    rescale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    rotation_range<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    width_shift_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    height_shift_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    shear_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    zoom_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    horizontal_flip<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    fill_mode<span class="op">=</span><span class="st">&#39;nearest&#39;</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>val_datagen <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>)  <span class="co"># Only rescale for validation set</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># we have the following directory paths set up</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>train_dir <span class="op">=</span> <span class="st">&#39;./train&#39;</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>validation_dir <span class="op">=</span> <span class="st">&#39;./validation&#39;</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>test_dir <span class="op">=</span> <span class="st">&#39;./test2&#39;</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the actual data generators for the train and validation sets</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_datagen.flow_from_directory(</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    train_dir,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    target_size<span class="op">=</span>(<span class="dv">224</span>, <span class="dv">224</span>),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">32</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>val_data <span class="op">=</span> val_datagen.flow_from_directory(</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    validation_dir,</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    target_size<span class="op">=</span>(<span class="dv">224</span>, <span class="dv">224</span>),</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">32</span>,</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create test data generator</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> val_datagen.flow_from_directory(</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>    test_dir,</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    target_size<span class="op">=</span>(<span class="dv">224</span>, <span class="dv">224</span>),</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">32</span>,</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    shuffle<span class="op">=</span><span class="va">False</span>  <span class="co"># Typically we don&#39;t shuffle test data</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 42630 images belonging to 29 classes.
Found 15230 images belonging to 29 classes.
Found 0 images belonging to 29 classes.
</code></pre>
</div>
</div>
<section id="data-training" class="cell markdown" id="Ly6QT3THWtZa">
<h2>Data Training</h2>
<p>Load the Pre-trained Model without the Classification Head We'll
start by loading the Vision Transformer model without its pre-trained
classification head. This way, we can add our own output layer suited
for the number of classes in the dataset.</p>
</section>
<div class="cell markdown" id="RhjTS3NvWtZb">

</div>
<section id="data-preparation" class="cell markdown" id="-R1tjdhwWtZb">
<h4>Data Preparation</h4>
<p>we will need to transform the data appropriately for the model and
set up the DataLoader for batch processing. PyTorch's torchvision
library provides utilities for transforming and loading data
effectively.</p>
</section>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:211,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362863409,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="lWfa-v0bg6fI" data-outputId="82ec4092-c4de-48f4-ca0d-4b3d92aa8bd7">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>test_path <span class="op">=</span> <span class="st">&#39;test2&#39;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> [d.name <span class="cf">for</span> d <span class="kw">in</span> os.scandir(test_path) <span class="cf">if</span> d.is_dir()]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Classes found:&quot;</span>, classes)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cls <span class="kw">in</span> classes:</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    class_dir <span class="op">=</span> os.path.join(test_path, cls)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(class_dir) <span class="cf">if</span> os.path.isfile(os.path.join(class_dir, f))]</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Files in </span><span class="sc">{</span>cls<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>files[:<span class="dv">5</span>]<span class="sc">}</span><span class="ss">&quot;</span>)  <span class="co"># Print first 5 files in each class</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if there are any files in one of the class directories</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>example_class_path <span class="op">=</span> os.path.join(test_path, classes[<span class="dv">0</span>])  <span class="co"># Checking the first class directory</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>example_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(example_class_path) <span class="cf">if</span> f.endswith((<span class="st">&#39;.jpg&#39;</span>, <span class="st">&#39;.jpeg&#39;</span>, <span class="st">&#39;.png&#39;</span>, <span class="st">&#39;.ppm&#39;</span>, <span class="st">&#39;.bmp&#39;</span>, <span class="st">&#39;.pgm&#39;</span>, <span class="st">&#39;.tif&#39;</span>, <span class="st">&#39;.tiff&#39;</span>, <span class="st">&#39;.webp&#39;</span>))]</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Valid files in </span><span class="sc">{</span>classes[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>example_files[:<span class="dv">5</span>]<span class="sc">}</span><span class="ss">&quot;</span>)  <span class="co"># Print first 5 valid files in the first class</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Classes found: [&#39;L&#39;, &#39;G&#39;, &#39;K&#39;, &#39;S&#39;, &#39;nothing&#39;, &#39;D&#39;, &#39;P&#39;, &#39;T&#39;, &#39;N&#39;, &#39;Q&#39;, &#39;H&#39;, &#39;U&#39;, &#39;Y&#39;, &#39;J&#39;, &#39;O&#39;, &#39;B&#39;, &#39;W&#39;, &#39;I&#39;, &#39;M&#39;, &#39;space&#39;, &#39;A&#39;, &#39;E&#39;, &#39;R&#39;, &#39;del&#39;, &#39;Z&#39;, &#39;C&#39;, &#39;F&#39;, &#39;X&#39;, &#39;V&#39;]
Files in L: [&#39;Image_26705.jpg&#39;, &#39;Image_263.jpg&#39;, &#39;Image_59978.jpg&#39;, &#39;Image_18300.jpg&#39;, &#39;Image_13735.jpg&#39;]
Files in G: [&#39;Image_17568.jpg&#39;, &#39;Image_57664.jpg&#39;, &#39;Image_40437.jpg&#39;, &#39;Image_6189.jpg&#39;, &#39;Image_13990.jpg&#39;]
Files in K: [&#39;Image_39482.jpg&#39;, &#39;Image_40540.jpg&#39;, &#39;Image_30435.jpg&#39;, &#39;Image_54178.jpg&#39;, &#39;Image_59058.jpg&#39;]
Files in S: [&#39;Image_907.jpg&#39;, &#39;Image_50433.jpg&#39;, &#39;Image_7028.jpg&#39;, &#39;Image_29499.jpg&#39;, &#39;Image_47211.jpg&#39;]
Files in nothing: [&#39;Image_45628.jpg&#39;, &#39;Image_5747.jpg&#39;, &#39;Image_12916.jpg&#39;, &#39;Image_2794.jpg&#39;, &#39;Image_24354.jpg&#39;]
Files in D: [&#39;Image_42794.jpg&#39;, &#39;Image_1069.jpg&#39;, &#39;Image_49198.jpg&#39;, &#39;Image_52890.jpg&#39;, &#39;Image_36234.jpg&#39;]
Files in P: [&#39;Image_3877.jpg&#39;, &#39;Image_18957.jpg&#39;, &#39;Image_51873.jpg&#39;, &#39;Image_34880.jpg&#39;, &#39;Image_34089.jpg&#39;]
Files in T: [&#39;Image_4348.jpg&#39;, &#39;Image_7375.jpg&#39;, &#39;Image_7607.jpg&#39;, &#39;Image_3735.jpg&#39;, &#39;Image_15398.jpg&#39;]
Files in N: [&#39;Image_56188.jpg&#39;, &#39;Image_927.jpg&#39;, &#39;Image_12765.jpg&#39;, &#39;Image_50945.jpg&#39;, &#39;Image_49721.jpg&#39;]
Files in Q: [&#39;Image_25163.jpg&#39;, &#39;Image_2756.jpg&#39;, &#39;Image_3394.jpg&#39;, &#39;Image_2623.jpg&#39;, &#39;Image_26407.jpg&#39;]
Files in H: [&#39;Image_51867.jpg&#39;, &#39;Image_29725.jpg&#39;, &#39;Image_28715.jpg&#39;, &#39;Image_41379.jpg&#39;, &#39;Image_9254.jpg&#39;]
Files in U: [&#39;Image_40066.jpg&#39;, &#39;Image_50330.jpg&#39;, &#39;Image_38161.jpg&#39;, &#39;Image_57729.jpg&#39;, &#39;Image_39037.jpg&#39;]
Files in Y: [&#39;Image_18064.jpg&#39;, &#39;Image_12738.jpg&#39;, &#39;Image_45328.jpg&#39;, &#39;Image_54417.jpg&#39;, &#39;Image_44199.jpg&#39;]
Files in J: [&#39;Image_10507.jpg&#39;, &#39;Image_3419.jpg&#39;, &#39;Image_55970.jpg&#39;, &#39;Image_34923.jpg&#39;, &#39;Image_56444.jpg&#39;]
Files in O: [&#39;Image_55656.jpg&#39;, &#39;Image_55563.jpg&#39;, &#39;Image_14039.jpg&#39;, &#39;Image_5946.jpg&#39;, &#39;Image_17929.jpg&#39;]
Files in B: [&#39;Image_21844.jpg&#39;, &#39;Image_20049.jpg&#39;, &#39;Image_7328.jpg&#39;, &#39;Image_24780.jpg&#39;, &#39;Image_36603.jpg&#39;]
Files in W: [&#39;Image_53861.jpg&#39;, &#39;Image_27293.jpg&#39;, &#39;Image_52141.jpg&#39;, &#39;Image_5119.jpg&#39;, &#39;Image_24831.jpg&#39;]
Files in I: [&#39;Image_1158.jpg&#39;, &#39;Image_5678.jpg&#39;, &#39;Image_36579.jpg&#39;, &#39;Image_44271.jpg&#39;, &#39;Image_27823.jpg&#39;]
Files in M: [&#39;Image_24333.jpg&#39;, &#39;Image_8195.jpg&#39;, &#39;Image_42758.jpg&#39;, &#39;Image_38513.jpg&#39;, &#39;Image_21111.jpg&#39;]
Files in space: [&#39;Image_52365.jpg&#39;, &#39;Image_8855.jpg&#39;, &#39;Image_17027.jpg&#39;, &#39;Image_2095.jpg&#39;, &#39;Image_15696.jpg&#39;]
Files in A: [&#39;Image_11120.jpg&#39;, &#39;Image_49688.jpg&#39;, &#39;Image_27531.jpg&#39;, &#39;Image_4378.jpg&#39;, &#39;Image_9536.jpg&#39;]
Files in E: [&#39;Image_33424.jpg&#39;, &#39;Image_30335.jpg&#39;, &#39;Image_54545.jpg&#39;, &#39;Image_59833.jpg&#39;, &#39;Image_30855.jpg&#39;]
Files in R: [&#39;Image_21820.jpg&#39;, &#39;Image_54237.jpg&#39;, &#39;Image_47164.jpg&#39;, &#39;Image_4173.jpg&#39;, &#39;Image_966.jpg&#39;]
Files in del: [&#39;Image_11430.jpg&#39;, &#39;Image_31538.jpg&#39;, &#39;Image_31177.jpg&#39;, &#39;Image_13421.jpg&#39;, &#39;Image_40676.jpg&#39;]
Files in Z: [&#39;Image_3155.jpg&#39;, &#39;Image_60856.jpg&#39;, &#39;Image_60198.jpg&#39;, &#39;Image_54102.jpg&#39;, &#39;Image_22126.jpg&#39;]
Files in C: [&#39;Image_44228.jpg&#39;, &#39;Image_9615.jpg&#39;, &#39;Image_32790.jpg&#39;, &#39;Image_9842.jpg&#39;, &#39;Image_19410.jpg&#39;]
Files in F: [&#39;Image_34060.jpg&#39;, &#39;Image_41340.jpg&#39;, &#39;Image_3886.jpg&#39;, &#39;Image_39158.jpg&#39;, &#39;Image_58895.jpg&#39;]
Files in X: [&#39;Image_37340.jpg&#39;, &#39;Image_10915.jpg&#39;, &#39;Image_15356.jpg&#39;, &#39;Image_45728.jpg&#39;, &#39;Image_44058.jpg&#39;]
Files in V: [&#39;Image_20025.jpg&#39;, &#39;Image_15542.jpg&#39;, &#39;Image_19994.jpg&#39;, &#39;Image_40372.jpg&#39;, &#39;Image_40882.jpg&#39;]
Valid files in L: [&#39;Image_26705.jpg&#39;, &#39;Image_263.jpg&#39;, &#39;Image_59978.jpg&#39;, &#39;Image_18300.jpg&#39;, &#39;Image_13735.jpg&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="25"
data-executionInfo="{&quot;elapsed&quot;:264,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362873808,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="D0_roknNWtZb">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchvision <span class="im">import</span> datasets, transforms</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformations for the input data</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>)),  <span class="co"># Resize images to fit model input requirements</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    transforms.ToTensor(),  <span class="co"># Convert images to tensor format</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])  <span class="co"># Normalize images</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load datasets</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> datasets.ImageFolder(<span class="st">&#39;train&#39;</span>, transform<span class="op">=</span>transform)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>valid_dataset <span class="op">=</span> datasets.ImageFolder(<span class="st">&#39;validation&#39;</span>, transform<span class="op">=</span>transform)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>test_dataset <span class="op">=</span>datasets.ImageFolder(<span class="st">&#39;test2&#39;</span>, transform<span class="op">=</span>transform)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Data loaders</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> DataLoader(train_dataset, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>valid_loader <span class="op">=</span> DataLoader(valid_dataset, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> DataLoader(test_dataset, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<section id="model-setup" class="cell markdown" id="DWNl4bKeWtZc">
<h4>Model Setup</h4>
<p>Initialize your model and move it to the appropriate device (CPU or
GPU).</p>
</section>
<div class="cell code" data-execution_count="23"
data-executionInfo="{&quot;elapsed&quot;:767,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713330086374,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="4Hsh-IIfWtZc">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> ViTModel, ViTConfig</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomViTModel(nn.Module):</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_classes):</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(CustomViTModel, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        config <span class="op">=</span> ViTConfig.from_pretrained(<span class="st">&#39;google/vit-base-patch16-224&#39;</span>, output_hidden_states<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.vit <span class="op">=</span> ViTModel.from_pretrained(<span class="st">&#39;google/vit-base-patch16-224&#39;</span>, config<span class="op">=</span>config)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Freeze all the layers in the base model</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> param <span class="kw">in</span> <span class="va">self</span>.vit.parameters():</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>            param.requires_grad <span class="op">=</span> <span class="va">False</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Assuming the output feature size from ViT&#39;s CLS token is 768</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        feature_dim <span class="op">=</span> <span class="va">self</span>.vit.config.hidden_size</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc <span class="op">=</span> nn.Linear(feature_dim, <span class="dv">512</span>)  <span class="co"># Adjust input features to match ViT output</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.relu <span class="op">=</span> nn.ReLU()</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.classifier <span class="op">=</span> nn.Linear(<span class="dv">512</span>, num_classes)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, inputs):</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> <span class="va">self</span>.vit(inputs)  <span class="co"># Directly pass tensor inputs</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>        cls_token <span class="op">=</span> outputs.last_hidden_state[:, <span class="dv">0</span>, :]  <span class="co"># Only use the CLS token</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc(cls_token)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.classifier(x)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:240,&quot;referenced_widgets&quot;:[&quot;2be7741ace984a80bd3bc6d414f90a49&quot;,&quot;a346408d889240a99c09a091b68fc239&quot;,&quot;64280395b0fe4834a0f62436562dff25&quot;,&quot;3f7fe71a9f584876a57b7aab824716ab&quot;,&quot;05a3f3fa8e704359b4db735533c595d1&quot;,&quot;28aca3c1f3aa4c92b03fd035c7cbfee1&quot;,&quot;07aba57cb1db4fed9dcbb83f4d5618ac&quot;,&quot;70e59e57c44b4410ab3c7461ed6c5db3&quot;,&quot;dcc8de2f39754914a3253c03ed08cb01&quot;,&quot;d143a8243eef4b0ea9eddd6f2b50a251&quot;,&quot;7f21096ca5ba45eaa4592c33313474f4&quot;,&quot;27c63a561f2e494c855663400cec70c7&quot;,&quot;2b9b1ceee67c436f8f42884255625bf2&quot;,&quot;d852da56354e4489b1438402c026b6ed&quot;,&quot;b51178c821d646938fb97729a925d85e&quot;,&quot;4f749d702a39460ab2bd7547156f7718&quot;,&quot;648ef01b670d476fb32263cd76e607e7&quot;,&quot;e9bb85ac5e6f44dc9eecd22d9a3a051f&quot;,&quot;efeaaa99f6434a73907497d22f252916&quot;,&quot;d477046dd35945ba8ae63b2585682af8&quot;,&quot;1ef30fc0486848dfbc924e907b71bfac&quot;,&quot;f21208431ea94d3ca0d45cb4f48d86ef&quot;]}"
data-executionInfo="{&quot;elapsed&quot;:3672,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713330102856,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="W6bvUWUhWtZc" data-outputId="2a157970-5fb1-42f4-8b34-44177cf94ba3">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> torch.device(<span class="st">&quot;cuda&quot;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&quot;cpu&quot;</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> CustomViTModel(num_classes<span class="op">=</span><span class="dv">29</span>).to(device)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb47"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;2be7741ace984a80bd3bc6d414f90a49&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb48"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;27c63a561f2e494c855663400cec70c7&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>Some weights of ViTModel were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized: [&#39;vit.pooler.dense.bias&#39;, &#39;vit.pooler.dense.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</code></pre>
</div>
</div>
<div class="cell markdown" id="E5bTcIWFWtZd">
<ol>
<li>Define Loss Function and Optimizer Setting up the loss function and
the optimizer. Here, we use CrossEntropyLoss for multi-class
classification and Adam optimizer.</li>
</ol>
</div>
<div class="cell code" data-execution_count="26"
data-executionInfo="{&quot;elapsed&quot;:333,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713330106980,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="VMayZiUBWtZd">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)  <span class="co"># Learning rate</span></span></code></pre></div>
</div>
<section id="initialize-variables-for-tracking-best-model"
class="cell markdown" id="AqoOpbUzWtZe">
<h4>Initialize Variables for Tracking Best Model</h4>
<p>Before starting the training loop, initialize variables to track the
best model based on the validation loss.</p>
</section>
<div class="cell code" data-execution_count="27"
data-executionInfo="{&quot;elapsed&quot;:592,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713330111512,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="kGTJRLj6WtZe">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>best_val_loss <span class="op">=</span> <span class="bu">float</span>(<span class="st">&#39;inf&#39;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>best_model_path <span class="op">=</span> <span class="st">&#39;vit_best_model.pth&#39;</span>  <span class="co"># Path where the best model will be saved</span></span></code></pre></div>
</div>
<section id="training-loop" class="cell markdown" id="73vmsnXZWtZf">
<h4>Training Loop<Br></h4>
<p>Implement the training loop, including validation to monitor the
performance on unseen data.<br> Within the training loop, after the
validation phase, compare the current epoch's validation loss with the
best validation loss tracked. If the current loss is lower, update the
best loss and save the model.<br> Explanation<br> Tracking the Best
Model: By checking if the validation loss of the current epoch is lower
than the best recorded loss (best_val_loss), the model's parameters are
saved only when they represent an improvement. Saving the Model:
torch.save is used to save the model's state dictionary to the file
specified by best_model_path. The state dictionary includes all model
parameters.</p>
</section>
<section id="vision-transformer-vit" class="cell markdown"
id="U_L551O2WtZg">
<h4>Vision Transformer (ViT):</h4>
<p>The Vision Transformer (ViT) model, originally developed by
researchers at Google, applies the principles of transformers—a
breakthrough architecture in natural language processing—to the field of
image classification. Unlike conventional convolutional neural networks
(CNNs) that process images through local filters, ViT treats an image as
a sequence of patches and uses self-attention mechanisms to capture
complex relationships between these patches across the entire image.
This allows ViT to understand broader and more abstract visual patterns
effectively.</p>
<p>For sign language image classification, ViT is particularly
advantageous because of its ability to focus on the spatial
relationships and distinct features within each sign language pose or
gesture. Each hand sign involves specific configurations and
orientations of fingers and palms, which are crucial for accurate
classification. The global receptive field of ViT, facilitated by its
self-attention layers, enables it to capture these nuances across the
whole image, leading to potentially higher accuracy and better
performance than traditional CNNs. This makes the Vision Transformer a
compelling choice for tasks like sign language recognition, where
precision in interpreting visual details is essential.<br>
<strong>Understanding Vision Transformer Output</strong> A standard
Vision Transformer (ViT) model outputs a sequence of token embeddings.
using the default setup, the sequence includes:</p>
<p>A class token (CLS token) embedding, which is typically used for
classification tasks. A set of patch embeddings corresponding to parts
of the input image. For classification, we typically would only use the
CLS token's embedding, which is the first token in the sequence output
by the ViT model.</p>
<p>References:<br> <a
href="https://huggingface.co/docs/transformers/en/model_doc/vit">ViT
Model Documentation on Hugging Face</a><br> <a
href="https://huggingface.co/google/vit-base-patch16-224">ViT Base
Patch16-224 on Hugging Face</a><br> <a
href="https://arxiv.org/abs/2010.11929">An Image is Worth 16x16 Words:
Transformers for Image Recognition at Scale - arXiv</a></p>
</section>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:783}"
data-executionInfo="{&quot;elapsed&quot;:8739193,&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1713338854966,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="w6AIMii8WtZg" data-outputId="2e286d29-7c6c-4995-bedd-5a41c59dea3e">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>num_epochs <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(num_epochs):</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    model.train()  <span class="co"># Set model to training mode</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    running_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> train_loader:</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        images, labels <span class="op">=</span> images.to(device), labels.to(device)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(images)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, labels)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Backward and optimize</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>        running_loss <span class="op">+=</span> loss.item()</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validation phase</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()  <span class="co"># Set model to evaluation mode</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    valid_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> images, labels <span class="kw">in</span> valid_loader:</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>            images, labels <span class="op">=</span> images.to(device), labels.to(device)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(images)</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, labels)</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>            valid_loss <span class="op">+=</span> loss.item()</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>            _, predicted <span class="op">=</span> torch.<span class="bu">max</span>(outputs.data, <span class="dv">1</span>)</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> labels.size(<span class="dv">0</span>)</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>            correct <span class="op">+=</span> (predicted <span class="op">==</span> labels).<span class="bu">sum</span>().item()</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>    epoch_loss <span class="op">=</span> running_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>    epoch_val_loss <span class="op">=</span> valid_loss <span class="op">/</span> <span class="bu">len</span>(valid_loader)</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>    epoch_acc <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">], Loss: </span><span class="sc">{</span>epoch_loss<span class="sc">:.4f}</span><span class="ss">, Validation Loss: </span><span class="sc">{</span>epoch_val_loss<span class="sc">:.4f}</span><span class="ss">, Accuracy: </span><span class="sc">{</span>epoch_acc<span class="sc">:.2f}</span><span class="ss">%&#39;</span>)</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save the model if validation loss has decreased</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch_val_loss <span class="op">&lt;</span> best_val_loss:</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;Validation loss decreased (</span><span class="sc">{</span>best_val_loss<span class="sc">:.4f}</span><span class="ss"> --&gt; </span><span class="sc">{</span>epoch_val_loss<span class="sc">:.4f}</span><span class="ss">). Saving model...&#39;</span>)</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>        best_val_loss <span class="op">=</span> epoch_val_loss</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>        torch.save(model.state_dict(), best_model_path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch [1/50], Loss: 0.2359, Validation Loss: 0.0600, Accuracy: 98.23%
Validation loss decreased (inf --&gt; 0.0600). Saving model...
Epoch [2/50], Loss: 0.0529, Validation Loss: 0.0359, Accuracy: 98.88%
Validation loss decreased (0.0600 --&gt; 0.0359). Saving model...
Epoch [3/50], Loss: 0.0364, Validation Loss: 0.0311, Accuracy: 99.03%
Validation loss decreased (0.0359 --&gt; 0.0311). Saving model...
Epoch [4/50], Loss: 0.0305, Validation Loss: 0.0699, Accuracy: 98.05%
Epoch [5/50], Loss: 0.0297, Validation Loss: 0.0273, Accuracy: 99.20%
Validation loss decreased (0.0311 --&gt; 0.0273). Saving model...
Epoch [6/50], Loss: 0.0232, Validation Loss: 0.0642, Accuracy: 98.09%
Epoch [7/50], Loss: 0.0231, Validation Loss: 0.0272, Accuracy: 99.23%
Validation loss decreased (0.0273 --&gt; 0.0272). Saving model...
Epoch [8/50], Loss: 0.0194, Validation Loss: 0.0494, Accuracy: 98.92%
Epoch [9/50], Loss: 0.0223, Validation Loss: 0.0358, Accuracy: 99.13%
Epoch [10/50], Loss: 0.0164, Validation Loss: 0.0714, Accuracy: 98.43%
Epoch [11/50], Loss: 0.0208, Validation Loss: 0.0178, Accuracy: 99.56%
Validation loss decreased (0.0272 --&gt; 0.0178). Saving model...
Epoch [12/50], Loss: 0.0187, Validation Loss: 0.0207, Accuracy: 99.43%
Epoch [13/50], Loss: 0.0136, Validation Loss: 0.1146, Accuracy: 98.00%
Epoch [14/50], Loss: 0.0211, Validation Loss: 0.0428, Accuracy: 98.91%
Epoch [15/50], Loss: 0.0129, Validation Loss: 0.0566, Accuracy: 98.90%
Epoch [16/50], Loss: 0.0166, Validation Loss: 0.0244, Accuracy: 99.46%
Epoch [17/50], Loss: 0.0150, Validation Loss: 0.0947, Accuracy: 98.42%
Epoch [18/50], Loss: 0.0151, Validation Loss: 0.0255, Accuracy: 99.43%
Epoch [19/50], Loss: 0.0127, Validation Loss: 0.0461, Accuracy: 99.18%
Epoch [20/50], Loss: 0.0145, Validation Loss: 0.0470, Accuracy: 99.04%
Epoch [21/50], Loss: 0.0135, Validation Loss: 0.0202, Accuracy: 99.50%
Epoch [22/50], Loss: 0.0166, Validation Loss: 0.0300, Accuracy: 99.47%
Epoch [23/50], Loss: 0.0136, Validation Loss: 0.0459, Accuracy: 99.10%
Epoch [24/50], Loss: 0.0149, Validation Loss: 0.0645, Accuracy: 98.93%
Epoch [25/50], Loss: 0.0101, Validation Loss: 0.0486, Accuracy: 99.24%
Epoch [26/50], Loss: 0.0125, Validation Loss: 0.0460, Accuracy: 99.31%
Epoch [27/50], Loss: 0.0118, Validation Loss: 0.1076, Accuracy: 98.43%
</code></pre>
</div>
<div class="output error" data-ename="KeyboardInterrupt" data-evalue="">
<pre><code>---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
&lt;ipython-input-28-5f7a1f4c136e&gt; in &lt;cell line: 3&gt;()
     15         optimizer.step()
     16 
---&gt; 17         running_loss += loss.item()
     18 
     19     # Validation phase

KeyboardInterrupt: 
</code></pre>
</div>
</div>
<section id="plotting-training-an-validation-acuraccy-and-loss"
class="cell markdown" id="hzN576_r3gIy">
<h1>Plotting Training an Validation acuraccy and Loss</h1>
</section>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
data-executionInfo="{&quot;elapsed&quot;:1121,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713338866295,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="9QGRSWUr7TMM" data-outputId="80503630-28ef-4cb1-a410-2eced910f865">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#as we fotgot to save the accuracy and loss metrics at each epoch,we will</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#try to make alternative way for  plotting them</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#by using printed logs,and plot the metrics manually:</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#by Creating lists in Python with these values.</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Data extracted from the training logs</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>train_losses <span class="op">=</span> [<span class="fl">0.2359</span>, <span class="fl">0.0529</span>, <span class="fl">0.0364</span>, <span class="fl">0.0305</span>, <span class="fl">0.0297</span>, <span class="fl">0.0232</span>, <span class="fl">0.0231</span>, <span class="fl">0.0194</span>, <span class="fl">0.0223</span>, <span class="fl">0.0164</span>, <span class="fl">0.0208</span>, <span class="fl">0.0187</span>, <span class="fl">0.0136</span>, <span class="fl">0.0211</span>, <span class="fl">0.0129</span>, <span class="fl">0.0166</span>, <span class="fl">0.0150</span>, <span class="fl">0.0151</span>, <span class="fl">0.0127</span>, <span class="fl">0.0145</span>, <span class="fl">0.0135</span>, <span class="fl">0.0166</span>, <span class="fl">0.0136</span>, <span class="fl">0.0149</span>, <span class="fl">0.0101</span>]</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>valid_losses <span class="op">=</span> [<span class="fl">0.0600</span>, <span class="fl">0.0359</span>, <span class="fl">0.0311</span>, <span class="fl">0.0699</span>, <span class="fl">0.0273</span>, <span class="fl">0.0642</span>, <span class="fl">0.0272</span>, <span class="fl">0.0494</span>, <span class="fl">0.0358</span>, <span class="fl">0.0714</span>, <span class="fl">0.0178</span>, <span class="fl">0.0207</span>, <span class="fl">0.1146</span>, <span class="fl">0.0428</span>, <span class="fl">0.0566</span>, <span class="fl">0.0244</span>, <span class="fl">0.0947</span>, <span class="fl">0.0255</span>, <span class="fl">0.0461</span>, <span class="fl">0.0470</span>, <span class="fl">0.0202</span>, <span class="fl">0.0300</span>, <span class="fl">0.0459</span>, <span class="fl">0.0645</span>, <span class="fl">0.0486</span>]</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training and validation loss</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>plt.plot(train_losses, label<span class="op">=</span><span class="st">&#39;Training Loss&#39;</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>plt.plot(valid_losses, label<span class="op">=</span><span class="st">&#39;Validation Loss&#39;</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Training &amp; Validation Loss&#39;</span>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epochs&#39;</span>)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Loss&#39;</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/8f4d66e19f8d15646e3d2179e89be407c3e65311.png" /></p>
</div>
</div>
<div class="cell markdown" id="ggRb-qo0-a8L">
<p>Decreasing Loss: Initially, both training and validation loss drop
significantly, which is a good sign that the model is learning and
improving.</p>
<p>Validation Loss Fluctuations: There are noticeable fluctuations in
validation loss across epochs. This could be a sign of the model's
sensitivity to different data or possibly overfitting. If the model were
overfitting, you would typically see a continual decrease in training
loss but an increase in validation loss. However, since the validation
loss sometimes decreases to new lows, it's not a clear case of
overfitting but rather instability in the learning process.</p>
</div>
<div class="cell markdown" id="AbHYtr5Z7VYF">

</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1685,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713338956927,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="uDQcpW_z3gqb" data-outputId="08cde364-a4ca-41a0-d0f3-c62d7e8c741b">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> CustomViTModel(num_classes<span class="op">=</span><span class="dv">29</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the model weights(the best model that saved during traning)</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>model_path <span class="op">=</span> <span class="st">&#39;./vit_best_model.pth&#39;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>model.load_state_dict(torch.load(model_path))</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Move the model to the appropriate device</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> torch.device(<span class="st">&quot;cuda&quot;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&quot;cpu&quot;</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> model.to(device)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>Some weights of ViTModel were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized: [&#39;vit.pooler.dense.bias&#39;, &#39;vit.pooler.dense.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="38"
data-executionInfo="{&quot;elapsed&quot;:799,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713339748751,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="t_Q17lcn_Ldz">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell markdown" id="_ljK3K0O38Ei">
<p><strong>Prepare the Test Data</strong> Prepare our test dataset in a
similar fashion to how we prepared the training and validation datasets,
including applying the same transformations.</p>
</div>
<div class="cell markdown" id="k4JtBm7y4Q7F">
<p><strong>Evaluate the Model</strong> Setting the model to evaluation
mode and run it on the test data to evaluate its performance. Now the
model is ready to be evaluated on the test dataset</p>
</div>
<div class="cell code" data-execution_count="139"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:16445,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713349086462,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="mK54Jkk-SgiD" data-outputId="f8544547-6fff-49b2-a808-49cb16eeef0e">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize metrics</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># No need to track gradients for evaluation</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> test_loader:</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>        images, labels <span class="op">=</span> images.to(device), labels.to(device)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(images)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        _, predicted <span class="op">=</span> torch.<span class="bu">max</span>(outputs.data, <span class="dv">1</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> labels.size(<span class="dv">0</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>        correct <span class="op">+=</span> (predicted <span class="op">==</span> labels).<span class="bu">sum</span>().item()</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Accuracy of the model on the test images: </span><span class="sc">{</span>accuracy<span class="sc">:.2f}</span><span class="ss">%&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy of the model on the test images: 99.90%
</code></pre>
</div>
</div>
<div class="cell markdown" id="GY0G3FAXTQGu">
<p>An accuracy of 99.90% on the test images is outstanding! This
suggests that our model is performing exceptionally well on the unseen
data, indicating robust generalization and effective learning.</p>
</div>
<div class="cell code" data-execution_count="141"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:16335,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713349326478,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="2_p7rvgxkQs6" data-outputId="4ad2ff34-e892-42ec-e977-84753ad11524">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, classification_report</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>all_preds <span class="op">=</span> []</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>all_labels <span class="op">=</span> []</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> test_loader:</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>        images, labels <span class="op">=</span> images.to(<span class="st">&#39;cuda&#39;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&#39;cpu&#39;</span>), labels.to(<span class="st">&#39;cuda&#39;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&#39;cpu&#39;</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(images)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>        _, predicted <span class="op">=</span> torch.<span class="bu">max</span>(outputs, <span class="dv">1</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>        all_preds.extend(predicted.cpu().numpy())</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>        all_labels.extend(labels.cpu().numpy())</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(all_labels, all_preds))</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(all_labels, all_preds))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00       109
           1       1.00      1.00      1.00       107
           2       1.00      1.00      1.00       122
           3       1.00      1.00      1.00       109
           4       0.99      1.00      1.00       104
           5       1.00      1.00      1.00        97
           6       1.00      1.00      1.00        95
           7       1.00      1.00      1.00       117
           8       1.00      1.00      1.00       116
           9       1.00      1.00      1.00       109
          10       1.00      1.00      1.00        89
          11       1.00      1.00      1.00       113
          12       1.00      1.00      1.00        92
          13       1.00      1.00      1.00       124
          14       1.00      1.00      1.00       104
          15       1.00      1.00      1.00       109
          16       1.00      1.00      1.00       104
          17       1.00      1.00      1.00        97
          18       1.00      1.00      1.00        99
          19       0.99      1.00      1.00       102
          20       0.99      1.00      1.00       101
          21       1.00      0.99      1.00       102
          22       1.00      1.00      1.00        94
          23       1.00      0.99      1.00       110
          24       1.00      0.99      1.00       102
          25       1.00      1.00      1.00       105
          26       1.00      1.00      1.00       112
          27       1.00      1.00      1.00        98
          28       1.00      1.00      1.00        98

    accuracy                           1.00      3040
   macro avg       1.00      1.00      1.00      3040
weighted avg       1.00      1.00      1.00      3040

[[109   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0 107   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 122   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0 109   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0 104   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  97   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  95   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0 117   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0 116   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0 109   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  89   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0 113   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  92   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0 124   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0 104   0   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 109   0   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 104   0
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0  97
    0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   99   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0 102   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0 101   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   1 101   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0  94   0   0   0   0   0   0]
 [  0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0 109   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   1   0   0   0   0 101   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0 105   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0 112   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0  98   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0  98]]
</code></pre>
</div>
</div>
<div class="cell markdown" id="zlDiSDJOlRKq">
<p>now i am getting a result that i did'nt get like them on my
life!!</p>
</div>
<div class="cell markdown" id="yOKBKEpQl06o">
<p><strong>Generate Predictions and Ground Truth Labels<br></strong>
lets compare our model's predictions directly with the ground truth and
perform a detailed analysis</p>
</div>
<div class="cell code" data-execution_count="142"
data-executionInfo="{&quot;elapsed&quot;:17190,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713349648461,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="rEF1j4VzlqHO">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume model, test_loader are already defined and set up</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>all_preds <span class="op">=</span> []</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>all_labels <span class="op">=</span> []</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> test_loader:</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>        images <span class="op">=</span> images.to(<span class="st">&#39;cuda&#39;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&#39;cpu&#39;</span>)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> labels.to(<span class="st">&#39;cuda&#39;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&#39;cpu&#39;</span>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(images)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>        _, preds <span class="op">=</span> torch.<span class="bu">max</span>(outputs, <span class="dv">1</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        all_preds.extend(preds.cpu().numpy())  <span class="co"># Save predictions</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        all_labels.extend(labels.cpu().numpy())  <span class="co"># Save ground truth labels</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="144"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:815}"
data-executionInfo="{&quot;elapsed&quot;:2999,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713349785946,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="xUjRa31lmfmL" data-outputId="695cd26b-e2dc-48e0-df80-a372fd77b252">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a confusion matrix</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(all_labels, all_preds)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&quot;d&quot;</span>, linewidths<span class="op">=</span><span class="fl">.5</span>, square<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>            xticklabels<span class="op">=</span>test_dataset.classes,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>test_dataset.classes)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual label&#39;</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted label&#39;</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Accuracy Score: </span><span class="sc">{:.3f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(np.mean(all_preds <span class="op">==</span> all_labels)))</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/a8da33e241ca07f5e39a2251c28fbe511cf6a28d.png" /></p>
</div>
</div>
<div class="cell markdown" id="TS1mmgbfqP83">

</div>
<div class="cell markdown" id="_J9kgckfqQdh">
<p>Using a VGG16 model for our tasks can be an excellent choice,because
we're looking for a model that strikes a balance between complexity and
performance. VGG16 is well-known for its depth and robustness in
handling a wide range of image recognition tasks.below code shows how we
can implement and train a VGG16 model using PyTorch, including
modifications for custom class numbers29.</p>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:5114,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362924276,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="agb-8V7zqmkI" data-outputId="14d7ebc8-60ce-49fe-a198-f6346a497ba0">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision.models <span class="im">as</span> models</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load pre-trained VGG16 model</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> models.vgg16(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the last layer for 29 classes</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>num_classes <span class="op">=</span> <span class="dv">29</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>model.classifier[<span class="dv">6</span>] <span class="op">=</span> nn.Linear(model.classifier[<span class="dv">6</span>].in_features, num_classes)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Move model to GPU if available</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> torch.device(<span class="st">&quot;cuda&quot;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&quot;cpu&quot;</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>model.to(device)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter &#39;pretrained&#39; is deprecated since 0.13 and may be removed in the future, please use &#39;weights&#39; instead.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for &#39;weights&#39; are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: &quot;https://download.pytorch.org/models/vgg16-397923af.pth&quot; to /root/.cache/torch/hub/checkpoints/vgg16-397923af.pth
100%|██████████| 528M/528M [00:02&lt;00:00, 198MB/s]
</code></pre>
</div>
<div class="output execute_result" data-execution_count="26">
<pre><code>VGG(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace=True)
    (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (3): ReLU(inplace=True)
    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (6): ReLU(inplace=True)
    (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (8): ReLU(inplace=True)
    (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): ReLU(inplace=True)
    (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (13): ReLU(inplace=True)
    (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (15): ReLU(inplace=True)
    (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (18): ReLU(inplace=True)
    (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (20): ReLU(inplace=True)
    (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (22): ReLU(inplace=True)
    (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (25): ReLU(inplace=True)
    (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (27): ReLU(inplace=True)
    (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (29): ReLU(inplace=True)
    (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))
  (classifier): Sequential(
    (0): Linear(in_features=25088, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=29, bias=True)
  )
)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="27"
data-executionInfo="{&quot;elapsed&quot;:212,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713362936251,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="efyCkTPuqx5g">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Early stopping parameters</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>early_stopping_patience <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>best_val_accuracy <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>epochs_no_improve <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:2051614,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713365039398,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="a9zCRl2Yq1eb" data-outputId="f5071803-a281-408d-a7ec-743989ed5e9e">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;train_loss&#39;</span>: [],</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;train_acc&#39;</span>: [],</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;val_loss&#39;</span>: [],</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;val_acc&#39;</span>: []</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>num_epochs <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(num_epochs):</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training phase</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    model.train()</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    running_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    running_corrects <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> train_loader:</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>        images, labels <span class="op">=</span> images.to(device), labels.to(device)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(images)</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, labels)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>        _, preds <span class="op">=</span> torch.<span class="bu">max</span>(outputs, <span class="dv">1</span>)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>        running_loss <span class="op">+=</span> loss.item() <span class="op">*</span> images.size(<span class="dv">0</span>)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>        running_corrects <span class="op">+=</span> torch.<span class="bu">sum</span>(preds <span class="op">==</span> labels.data)</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> labels.size(<span class="dv">0</span>)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>    epoch_loss <span class="op">=</span> running_loss <span class="op">/</span> total</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>    epoch_acc <span class="op">=</span> running_corrects.double() <span class="op">/</span> total</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>    history[<span class="st">&#39;train_loss&#39;</span>].append(epoch_loss)</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>    history[<span class="st">&#39;train_acc&#39;</span>].append(epoch_acc.item())</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validation phase</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>    val_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>    val_corrects <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> images, labels <span class="kw">in</span> valid_loader:</span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>            images, labels <span class="op">=</span> images.to(device), labels.to(device)</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(images)</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, labels)</span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>            _, preds <span class="op">=</span> torch.<span class="bu">max</span>(outputs, <span class="dv">1</span>)</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>            val_loss <span class="op">+=</span> loss.item() <span class="op">*</span> images.size(<span class="dv">0</span>)</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>            val_corrects <span class="op">+=</span> torch.<span class="bu">sum</span>(preds <span class="op">==</span> labels.data)</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>        val_loss <span class="op">/=</span> total</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>        val_acc <span class="op">=</span> val_corrects.double() <span class="op">/</span> total</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>        history[<span class="st">&#39;val_loss&#39;</span>].append(val_loss)</span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>        history[<span class="st">&#39;val_acc&#39;</span>].append(val_acc.item())</span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Early stopping logic</span></span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> val_acc <span class="op">&gt;</span> best_val_accuracy:</span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>            best_val_accuracy <span class="op">=</span> val_acc</span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>            torch.save(model.state_dict(), <span class="st">&#39;best_model.pth&#39;</span>)</span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a>            epochs_no_improve <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>            epochs_no_improve <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> epochs_no_improve <span class="op">&gt;=</span> early_stopping_patience:</span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;Early stopping&quot;</span>)</span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Epoch </span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss"> - Train Loss: </span><span class="sc">{</span>epoch_loss<span class="sc">:.4f}</span><span class="ss">, Train Acc: </span><span class="sc">{</span>epoch_acc<span class="sc">:.4f}</span><span class="ss">, Val Loss: </span><span class="sc">{</span>val_loss<span class="sc">:.4f}</span><span class="ss">, Val Acc: </span><span class="sc">{</span>val_acc<span class="sc">:.4f}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/20 - Train Loss: 3.3755, Train Acc: 0.0348, Val Loss: 0.7221, Val Acc: 0.0076
Epoch 2/20 - Train Loss: 3.3706, Train Acc: 0.0325, Val Loss: 0.7218, Val Acc: 0.0079
Epoch 3/20 - Train Loss: 3.3696, Train Acc: 0.0330, Val Loss: 0.7219, Val Acc: 0.0068
Epoch 4/20 - Train Loss: 3.3693, Train Acc: 0.0344, Val Loss: 0.7220, Val Acc: 0.0068
Epoch 5/20 - Train Loss: 3.3698, Train Acc: 0.0344, Val Loss: 0.7220, Val Acc: 0.0075
Epoch 6/20 - Train Loss: 3.3694, Train Acc: 0.0352, Val Loss: 0.7218, Val Acc: 0.0071
Early stopping
</code></pre>
</div>
</div>
<div class="cell markdown" id="ByqVjPwarKGl">
<p><strong>Plotting the History<br></strong> After training, you can
plot the training and validation loss and accuracy</p>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
data-executionInfo="{&quot;elapsed&quot;:690,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713365901937,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="i622O0U4rNPJ" data-outputId="34ed13dc-3bfa-4877-aa4a-16a3a1365971">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting training and validation loss</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>plt.plot(history[<span class="st">&#39;train_loss&#39;</span>], label<span class="op">=</span><span class="st">&#39;Train Loss&#39;</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>plt.plot(history[<span class="st">&#39;val_loss&#39;</span>], label<span class="op">=</span><span class="st">&#39;Validation Loss&#39;</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Training and Validation Loss&#39;</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epochs&#39;</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Loss&#39;</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting training and validation accuracy</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>plt.plot(history[<span class="st">&#39;train_acc&#39;</span>], label<span class="op">=</span><span class="st">&#39;Train Accuracy&#39;</span>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>plt.plot(history[<span class="st">&#39;val_acc&#39;</span>], label<span class="op">=</span><span class="st">&#39;Validation Accuracy&#39;</span>)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Training and Validation Accuracy&#39;</span>)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epochs&#39;</span>)</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/cefd70fb4fbfa0c6e80c9022598bae2ccd277cb7.png" /></p>
</div>
</div>
<div class="cell markdown" id="SRTFmaDDr9L7">
<p><strong>Evaluate the VGG16 Model</strong> Now, lets calculate
accuracy and other metrics on the test set</p>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:28958,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713365937164,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="AOHjP3bKsF2K" data-outputId="41644d69-58aa-44cb-f8f4-6df63dda0eb8">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>all_preds <span class="op">=</span> []</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>all_targets <span class="op">=</span> []</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> test_loader:</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>        images, labels <span class="op">=</span> images.to(<span class="st">&#39;cuda&#39;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&#39;cpu&#39;</span>), labels.to(<span class="st">&#39;cuda&#39;</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">&#39;cpu&#39;</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(images)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        _, predicted <span class="op">=</span> torch.<span class="bu">max</span>(outputs.data, <span class="dv">1</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> labels.size(<span class="dv">0</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        correct <span class="op">+=</span> (predicted <span class="op">==</span> labels).<span class="bu">sum</span>().item()</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>        all_preds.extend(predicted.cpu().numpy())</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>        all_targets.extend(labels.cpu().numpy())</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> correct <span class="op">/</span> total</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Accuracy on the test images: </span><span class="sc">{</span>accuracy<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed classification report</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(all_targets, all_preds, target_names<span class="op">=</span>test_dataset.classes))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy on the test images: 0.04
              precision    recall  f1-score   support

           A       0.00      0.00      0.00       300
           B       0.00      0.00      0.00       313
           C       0.00      0.00      0.00       347
           D       0.00      0.00      0.00       305
           E       0.00      0.00      0.00       328
           F       0.00      0.00      0.00       304
           G       0.00      0.00      0.00       315
           H       0.00      0.00      0.00       311
           I       0.00      0.00      0.00       344
           J       0.00      0.00      0.00       322
           K       0.00      0.00      0.00       287
           L       0.00      0.00      0.00       329
           M       0.00      0.00      0.00       305
           N       0.00      0.00      0.00       342
           O       0.00      0.00      0.00       314
           P       0.00      0.00      0.00       319
           Q       0.00      0.00      0.00       325
           R       0.00      0.00      0.00       302
           S       0.00      0.00      0.00       291
           T       0.00      0.00      0.00       318
           U       0.00      0.00      0.00       314
           V       0.00      0.00      0.00       286
           W       0.04      1.00      0.07       326
           X       0.00      0.00      0.00       295
           Y       0.00      0.00      0.00       311
           Z       0.00      0.00      0.00       322
         del       0.00      0.00      0.00       316
     nothing       0.00      0.00      0.00       296
       space       0.00      0.00      0.00       348

    accuracy                           0.04      9135
   macro avg       0.00      0.03      0.00      9135
weighted avg       0.00      0.04      0.00      9135

</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:757}"
data-executionInfo="{&quot;elapsed&quot;:2181,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1713365958017,&quot;user&quot;:{&quot;displayName&quot;:&quot;Fatima Al Musawi&quot;,&quot;userId&quot;:&quot;00309147938713201068&quot;},&quot;user_tz&quot;:240}"
id="iUwP7QFDsMyp" data-outputId="05073cf8-8734-4eab-d13e-8c5adebb4ca0">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confusion matrix</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(all_targets, all_preds)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrix</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&quot;d&quot;</span>, xticklabels<span class="op">=</span>test_dataset.classes, yticklabels<span class="op">=</span>test_dataset.classes)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Confusion Matrix&#39;</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_920ac7dbbbba42898a6c3c165e3e6d39/26ba5877ff861f9792b8ec109ae2eec55bf21055.png" /></p>
</div>
</div>
<div class="cell markdown" id="TWN4xK9O-BLa">
<p>Achieving a very low accuracy of just 4% with a VGG16 model on the
test images suggests that there could be significant issues either with
how the model is configured or how the data is being processed and fed
into the model. This could be due to a variety of factors such as
improper preprocessing of images, incorrect resizing, or normalization
not aligning with what VGG16 expects (i.e., using the specific means and
standard deviations of the ImageNet dataset).</p>
</div>
<section id="summery-" class="cell markdown" id="mQhhb422_2XY">
<h2>Summery<br></h2>
<p>This notebook has embarked on an explorative journey from data
handling and preprocessing to training two distinctly different models:
the Vision Transformer (ViT) and VGG16, providing a comprehensive look
at their performance on an image classification task.</p>
<p><strong>Data Preparation</strong>: The process began with careful
preparation of the dataset, which involved normalization, resizing, and
augmenting the images to ensure they are suitable for model input. This
is crucial as proper image preprocessing can significantly impact model
performance. The data was then split into training, validation, and
testing sets to support robust model evaluation.</p>
<p>Model Training and Configuration:</p>
<p><strong>VGG16</strong>: Initially, the VGG16 model, a traditional
convolutional neural network known for its depth and robust feature
extraction capabilities, was configured. It was modified to cater to the
specific number of classes in the dataset (29 classes). Despite its
widespread success on various tasks, VGG16 achieved very low accuracy in
this instance, suggesting potential issues with model configuration,
training process, or data preparation. Vision Transformer (ViT): In
contrast, the Vision Transformer was also trained, which uses a
different approach by treating image patches as sequences, akin to
handling words in text using attention mechanisms. This model typically
excels when trained on large datasets or can leverage extensive
pre-training. Comparison and Analysis:</p>
<p>The stark difference in performance between VGG16 and ViT highlights
the importance of model choice based on the specific characteristics of
the dataset and task. ViT's ability to capture complex patterns and
relationships between distant parts of an image might give it an edge
for certain types of image data, especially those where contextual
understanding is crucial. The VGG16's poor performance could stem from
several factors such as inadequate training epochs, improper parameter
tuning, or suboptimal data preprocessing. This suggests that not only
the choice of model but also the tuning and setup significantly
influence the outcomes. <strong>Conclusion:</strong> This exploration
underscores the necessity of aligning the model architecture with the
dataset's nature and the task requirements. While traditional CNNs like
VGG16 are powerful, they may not always match the performance of newer
architectures like ViT, especially in scenarios involving large-scale or
complex image data. The analysis also stresses the importance of
meticulous data preprocessing, strategic model tuning, and the need for
rigorous evaluation through systematic training and validation
processes. Understanding why certain models underperform—whether due to
technical misconfigurations or fundamental limitations—is crucial for
refining model deployments and achieving optimal results.</p>
</section>
<div class="cell markdown" id="ftkUFNVQBOHT">

</div>
</body>
</html>
